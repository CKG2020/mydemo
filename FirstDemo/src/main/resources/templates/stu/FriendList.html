<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>好友列表</title>
    <link rel="stylesheet" type="text/css" href="http://unpkg.com/view-design/dist/styles/iview.css">
    <script type="text/javascript" src="http://vuejs.org/js/vue.min.js"></script>
    <script type="text/javascript" src="http://unpkg.com/view-design/dist/iview.min.js"></script>
    <script src="http://code.jquery.com/jquery-latest.js"></script>
</head>
<body onload="f()">
<div id="app">
    <!--    {{message}}-->
    <div class="layout">
        <layout :style="{minHeight: '100vh'}">
            <sider collapsible :collapsed-width="78" v-model="isCollapsed">
                <i-menu theme="dark" width="auto" :class="menuitemClasses" open-names="['1','2']">
                    <submenu name="1">
                        <template slot="title">
                            个人中心
                            <icon type="ios-paper"/>
                        </template>
                        <menu-item name="1-1"><span onclick="MoreInfo()">完善信息</span></menu-item>
                        <menu-item name="1-2">
                            <span onclick="Board()">
                                留言板
                            </span></menu-item>
                        <menu-item name="1-3">
                            <span onclick="Questions()">
                                调查问卷
                            </span></menu-item>
                        <menu-item name="1-4">
                            <span onclick="Analyzing()">
                                分析结果
                            </span></menu-item>
                    </submenu>
                    <submenu name="2">
                        <template slot="title">聊天室
                            <icon type="ios-people" />
                        </template>
                        <menu-item name="2-1">
                            <span>好友列表</span></menu-item>
                        <menu-item name="2-2">
                            <span onclick="chat()">聊天室</span>
                        </menu-item>
                    </submenu>
                </i-menu>
            </sider>
            <layout>
                <i-header :style="{background: '#fff', boxShadow: '0 2px 3px 2px rgba(0,0,0,.1)'}">
                    <div style="float: left;margin-left: 70%">
                        <h1>欢迎您 ! &nbsp;&nbsp; {{message}}</h1>
                    </div>
                    <a href="/Login" style="margin-left: 50px"> 注销</a>
                </i-header>
                <i-content :style="{padding: '0 16px 16px'}">
                    <breadcrumb :style="{margin: '16px 0'}">
                        {{info}}
                    </breadcrumb>
                    <card>
                        <div>
                            <i-button @click="value4 = true" type="primary">View Profile</i-button>
                            <drawer :closable="false" width="640" v-model="value4">
                                <p :style="pStyle">User Profile</p>
                                <p :style="pStyle">Personal</p>
                                <div class="demo-drawer-profile">
                                    <row>
                                        <i-col span="12">
                                            Full Name: Aresn
                                        </i-col>
                                        <i-col span="12">
                                            Gender: Male
                                        </i-col>
                                    </row>
                                    <row>
                                        <i-col span="12">
                                            Collage: 信息技术工程学院
                                        </i-col>
                                        <i-col span="12">
                                            Major: 软件工程
                                        </i-col>
                                    </row>
                                    <row>
                                        <i-col span="12">
                                            Birthday: May 14, 1991
                                        </i-col>
                                    </row>
                                </div>
                                <divider />
                                留言板
                            </drawer>
                        </div>
                        <div style="width: 60%">
                            <i-table border :columns="columns7" :data="data6"></i-table>
                        </div>
                    </card>
                </i-content>
            </layout>
        </layout>
    </div>
</div>

</body>
<script>
    var uu;

    function f(){
        $.ajax({
            url:'/search',
            type:'post',
            success(res) {
                let msg=JSON.stringify(res);
                msg=$.parseJSON(msg);
                uu=msg;
                console.log(res);
                console.log(res.sname);
                console.log(msg.sname);
                if(res.sname==null){
                    active("新用户!","请完善你的个人信息");
                }else{
                    active(msg.sname);
                }
            }
        })
    }
    function active(res,ss) {
        mVue.message=res;
        mVue.info=ss;
    }

    var mVue = new Vue({
        el:'#app',
        data(){
            return {
                message: '',
                info: '',
                isCollapsed: false,
                choose: '',
                result: '',
                thanks: '',
                columns7: [
                    {
                        title: 'Name',
                        key: 'name',
                        render: (h, params) => {
                            return h('div', [
                                h('Icon', {
                                    props: {
                                        type: 'person'
                                    }
                                }),
                                h('strong', params.row.name)
                            ]);
                        }
                    },
                    {
                        title: 'Action',
                        key: 'action',
                        width: 150,
                        align: 'center',
                        render: (h, params) => {
                            return h('div', [
                                h('Button', {
                                    props: {
                                        type: 'primary',
                                        size: 'small'
                                    },
                                    style: {
                                        marginRight: '5px'
                                    },
                                    on: {
                                        click: () => {
                                            this.show(params.index)
                                        }
                                    }
                                }, 'View'),
                                h('Button', {
                                    props: {
                                        type: 'error',
                                        size: 'small'
                                    },
                                    on: {
                                        click: () => {
                                            this.remove(params.index)
                                        }
                                    }
                                }, 'Delete')
                            ]);
                        }
                    }
                ],
                data6: [
                    {
                        name: 'John Brown',
                    },
                    {
                        name: 'Jim Green',
                    },
                    {
                        name: 'Joe Black',
                    },
                    {
                        name: 'Jon Snow',
                    }
                ],
                value4: false,
                pStyle: {
                    fontSize: '16px',
                    color: 'rgba(0,0,0,0.85)',
                    lineHeight: '24px',
                    display: 'block',
                    marginBottom: '16px'
                }

            }
        },
        computed: {
            menuitemClasses: function () {
                return [
                    'menu-item',
                    this.isCollapsed ? 'collapsed-menu' : ''
                ]
            },
        },
        methods: {
            show (index) {
                this.$Modal.info({
                    title: 'User Info',
                    content: `Name：${this.data6[index].name}`
                })
            },
            remove (index) {
                this.data6.splice(index, 1);
            }
        }
    });

    function chat() {
        mVue.choose="chat";
        window.location.href="/stu/chat";
    }
    function Questions() {
        mVue.choose="Questions";
        window.location.href="/stu/Questions/";
    }
    function Analyzing() {
        mVue.choose="Board";
        window.location.href="/stu/Analyzing/";
    }
    function MoreInfo() {
        // mVue.choose="Questions";
        window.location.href="/stu/MoreInfo/";
    }
    function Board() {
        mVue.choose="Board";
        window.location.href="/stu/Board/";
    }

</script>
</html>